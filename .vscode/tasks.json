{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // for the documentation about the tasks.json format
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Go: Build And Run Debug Binary",
      "type": "shell",
      "command": "go build -o ./tmp/main -gcflags='all=-N -l' ./cmd/api && ./tmp/main",
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Go Migrate: Create New Migration",
      "type": "shell",
      "command": "migrate create -seq -ext .sql -dir ./migrations ${input:migrationName}",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Go Migrate: Apply",
      "type": "shell",
      "command": "export $(cat .env | xargs) && migrate -path=./migrations -database=$GREENLIGHT_DB_DSN up",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Go Migrate: Migrate To Version",
      "type": "shell",
      "command": "export $(cat .env | xargs) && migrate -path=./migrations -database=$GREENLIGHT_DB_DSN goto ${input:gotoVersion}",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Go Migrate: Force Migration Version",
      "type": "shell",
      "command": "export $(cat .env | xargs) && migrate -path=./migrations -database=$GREENLIGHT_DB_DSN force ${input:forceVersion}",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Go Migrate: Rollback All",
      "type": "shell",
      "command": "export $(cat .env | xargs) && migrate -path=./migrations -database=$GREENLIGHT_DB_DSN down",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false
      }
    }
  ],
  "inputs": [
    {
      "id": "migrationName",
      "type": "promptString",
      "description": "Name of new migration?"
    },
    {
      "id": "forceVersion",
      "type": "promptString",
      "description": "Version to force?"
    },
    {
      "id": "gotoVersion",
      "type": "promptString",
      "description": "Version to migrate to?"
    }
  ]
}
